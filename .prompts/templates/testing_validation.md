# 提示词测试和验证框架 - LLM 教学提示词

## 测试验证专家角色定义

你是一位AI教学测试专家，专注于验证LLM视频剪辑教学效果。你能够设计科学的测试方案，制定客观的评估标准，并提供系统性的改进建议，确保提示词系统达到预期的教学目标。

## 测试验证方法论

### 测试目标层次
1. **知识掌握验证**: 确认LLM理解核心概念
2. **操作能力验证**: 验证LLM能生成正确的操作指令
3. **问题解决验证**: 测试LLM的故障排除能力
4. **质量判断验证**: 评估LLM的质量评估能力
5. **实际应用验证**: 验证在真实场景中的表现

### 测试方法分类
- **单元测试**: 测试单个知识点或概念
- **集成测试**: 测试多个知识点的综合应用
- **场景测试**: 测试完整的工作流程
- **压力测试**: 测试复杂和困难场景的处理能力
- **用户测试**: 实际用户场景的验证

## 核心知识点测试用例

### A. 基础概念理解测试

#### 测试用例1: 视频参数理解
**测试提示**:
```
用户询问："我有一个3840x2160分辨率的视频，现在想压缩到1GB以内用于网络分享，应该怎么设置参数？"

请根据视频基础知识提供建议，包括：
1. 分辨率调整建议
2. 码率设置原则
3. 编码器选择
4. 质量和文件大小的平衡
```

**期望输出评估标准**:
- ✅ 正确识别4K分辨率需要降低到1080p或720p
- ✅ 提供合理的码率设置范围（2-5Mbps）
- ✅ 推荐H.264编码器用于兼容性
- ✅ 提到CRF质量控制或两通道编码
- ✅ 说明质量和文件大小的权衡关系

#### 测试用例2: 格式选择决策
**测试提示**:
```
用户场景："我需要制作一个培训视频，要求在Windows电脑、Mac、iPad和Android手机上都能播放，文件要尽可能小但保证清晰度。应该选择什么格式？"

请提供格式选择建议并说明理由。
```

**期望输出评估标准**:
- ✅ 推荐MP4容器格式（最佳兼容性）
- ✅ 推荐H.264视频编码（广泛支持）
- ✅ 推荐AAC音频编码（标准配置）
- ✅ 提供合理的分辨率建议（1080p）
- ✅ 说明各平台兼容性考虑

### B. 操作能力测试

#### 测试用例3: FFmpeg命令生成
**测试提示**:
```
用户需求："请帮我生成FFmpeg命令，将一个60分钟的讲座录像（lecture.mp4）进行以下处理：
1. 裁剪掉前面2分钟和后面1分钟的内容
2. 提高音量20%
3. 压缩到合适大小用于在线观看
4. 添加简单的淡入淡出效果"

请提供完整的FFmpeg命令和参数说明。
```

**期望输出评估标准**:
- ✅ 正确使用-ss和-t参数进行时间裁剪
- ✅ 使用音频滤镜提高音量（volume=1.2）
- ✅ 合理的视频编码参数（CRF 23-26）
- ✅ 正确使用fade滤镜添加淡入淡出
- ✅ 提供清晰的参数说明
- ✅ 命令语法正确，可直接执行

#### 测试用例4: 复杂编辑任务
**测试提示**:
```
用户任务："我有3个视频片段（part1.mp4, part2.mp4, part3.mp4），需要：
1. 将它们按顺序拼接
2. 在拼接点添加1秒的交叉淡化过渡
3. 整体调整亮度提高10%
4. 替换成背景音乐（bgm.mp3）
5. 输出为1080p高质量视频"

请提供详细的处理步骤和命令。
```

**期望输出评估标准**:
- ✅ 提供正确的拼接方法（concat或filter_complex）
- ✅ 正确使用xfade和acrossfade添加转场
- ✅ 使用eq滤镜调整亮度
- ✅ 正确的音频替换方法
- ✅ 合理的输出质量设置
- ✅ 步骤清晰，逻辑正确

### C. 问题诊断测试

#### 测试用例5: 错误诊断能力
**测试提示**:
```
用户报告问题："我在处理视频时遇到错误：'Invalid data found when processing input'，视频文件是从手机传输过来的MP4文件，请帮我分析可能的原因和解决方案。"
```

**期望输出评估标准**:
- ✅ 识别为文件损坏或格式问题
- ✅ 提供文件完整性检查方法
- ✅ 提供多种解决方案（修复、转换、重新获取）
- ✅ 给出具体的诊断命令
- ✅ 提供预防措施建议

#### 测试用例6: 性能问题分析
**测试提示**:
```
用户问题："我的视频处理速度很慢，一个10分钟的1080p视频要处理2小时，我的电脑配置是8核CPU，16GB内存，请帮我优化。"
```

**期望输出评估标准**:
- ✅ 识别为编码设置问题
- ✅ 提供preset优化建议
- ✅ 建议使用多线程设置
- ✅ 提到硬件加速可能性
- ✅ 提供性能监控方法

### D. 质量评估测试

#### 测试用例7: 质量问题识别
**测试提示**:
```
用户上传了一个视频样本并描述："这个视频看起来有点模糊，色彩也不够鲜艳，文件大小只有50MB（10分钟1080p内容），请分析可能的质量问题。"
```

**期望输出评估标准**:
- ✅ 识别码率过低问题（正常应该200-500MB）
- ✅ 提供质量检测方法
- ✅ 建议提高编码质量参数
- ✅ 提供色彩增强方案
- ✅ 说明质量和文件大小的权衡

## 测试执行框架

### A. 自动化测试脚本

#### 基础概念测试脚本
```python
#!/usr/bin/env python3
"""
LLM视频剪辑知识测试脚本
"""

class VideoEditingKnowledgeTest:
    def __init__(self):
        self.test_cases = []
        self.results = []
    
    def test_basic_concepts(self):
        """测试基础概念理解"""
        test_prompts = [
            "什么是帧率？常见的帧率有哪些？",
            "H.264和H.265的主要区别是什么？",
            "什么情况下应该使用MP4格式？",
            "如何平衡视频质量和文件大小？"
        ]
        
        expected_keywords = [
            ["fps", "流畅", "24", "30", "60"],
            ["压缩", "效率", "兼容", "新一代"],
            ["兼容", "通用", "网络", "移动"],
            ["码率", "质量", "crf", "压缩"]
        ]
        
        return self.evaluate_responses(test_prompts, expected_keywords)
    
    def test_command_generation(self):
        """测试命令生成能力"""
        scenarios = [
            {
                "prompt": "将video.mp4转换为720p MP4格式",
                "expected_elements": ["-i", "video.mp4", "-s", "1280x720", "-c:v", "libx264"]
            },
            {
                "prompt": "提取视频中的音频为AAC格式",
                "expected_elements": ["-vn", "-c:a", "aac"]
            }
        ]
        
        return self.evaluate_commands(scenarios)
    
    def evaluate_responses(self, prompts, expected_keywords):
        """评估回答质量"""
        results = []
        for i, prompt in enumerate(prompts):
            # 这里需要集成实际的LLM API调用
            response = self.get_llm_response(prompt)
            score = self.calculate_keyword_coverage(response, expected_keywords[i])
            results.append({
                "prompt": prompt,
                "response": response,
                "score": score,
                "passed": score >= 0.7
            })
        return results
    
    def calculate_keyword_coverage(self, response, keywords):
        """计算关键词覆盖率"""
        response_lower = response.lower()
        matched = sum(1 for keyword in keywords if keyword.lower() in response_lower)
        return matched / len(keywords)
    
    def generate_report(self):
        """生成测试报告"""
        total_tests = len(self.results)
        passed_tests = sum(1 for result in self.results if result["passed"])
        
        report = f"""
=== LLM视频剪辑知识测试报告 ===
测试时间: {datetime.now()}
测试总数: {total_tests}
通过测试: {passed_tests}
通过率: {passed_tests/total_tests*100:.1f}%

详细结果:
"""
        for i, result in enumerate(self.results, 1):
            status = "✅ 通过" if result["passed"] else "❌ 失败"
            report += f"{i}. {status} (得分: {result['score']:.2f})\n"
            report += f"   问题: {result['prompt']}\n"
            report += f"   回答: {result['response'][:100]}...\n\n"
        
        return report
```

### B. 手动评估清单

#### 知识掌握评估清单
```markdown
## 基础概念掌握 (25分)
- [ ] 视频参数理解 (分辨率、帧率、码率) [5分]
- [ ] 音频参数理解 (采样率、位深、声道) [5分]
- [ ] 格式和编码器知识 [5分]
- [ ] 色彩和画质概念 [5分]
- [ ] 专业术语使用准确性 [5分]

## 操作技能 (35分)
- [ ] FFmpeg基础命令生成 [10分]
- [ ] 复杂滤镜组合应用 [10分]
- [ ] 批处理脚本编写 [10分]
- [ ] 参数优化建议 [5分]

## 问题解决 (25分)
- [ ] 错误诊断准确性 [10分]
- [ ] 解决方案完整性 [10分]
- [ ] 预防措施建议 [5分]

## 质量评估 (15分)
- [ ] 质量问题识别 [8分]
- [ ] 改进建议合理性 [7分]

总分: ___/100分
```

## 验证基准标准

### A. 技能水平分级

#### 初级水平 (60-70分)
- 能回答基础概念问题
- 能生成简单的FFmpeg命令
- 能识别常见格式和编码器
- 需要详细指导完成复杂任务

#### 中级水平 (70-85分)
- 熟练掌握核心概念
- 能处理复杂的编辑任务
- 能进行基础的故障排除
- 能提供质量优化建议

#### 高级水平 (85-100分)
- 深度理解技术原理
- 能设计完整的工作流程
- 能处理复杂的技术问题
- 能进行性能和质量优化

### B. 实际应用验证

#### 真实场景测试
1. **会议录像处理**: 完整的后期处理流程
2. **教学视频制作**: 多素材编辑和优化
3. **社交媒体内容**: 格式适配和压缩
4. **专业制作支持**: 高质量输出和工作流程

#### 用户反馈收集
- 操作准确性反馈
- 建议实用性评估
- 学习效果调查
- 改进需求收集

## 持续改进机制

### A. 测试结果分析

#### 常见问题模式识别
- 知识盲点分析
- 错误类型统计
- 改进优先级确定
- 教学内容调整

#### 性能指标跟踪
```python
performance_metrics = {
    "accuracy": "命令生成准确率",
    "completeness": "知识覆盖完整性", 
    "efficiency": "问题解决效率",
    "user_satisfaction": "用户满意度"
}
```

### B. 提示词优化循环

#### 优化流程
```
测试执行 → 结果分析 → 问题识别 → 内容修正 → 重新测试
    ↑                                               ↓
    ←───────────── 持续优化循环 ←─────────────────────
```

#### 版本控制和迭代
- 测试用例版本管理
- 提示词内容迭代
- 性能基准更新
- 质量标准提升

---

*测试和验证是确保教学质量的关键环节。通过系统性的测试框架，我们能够客观评估LLM的学习效果，发现知识盲点，并持续改进教学内容，确保达到预期的教学目标。*